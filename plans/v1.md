# Replay

## Overview
The website is called "Replay". The website will create a playlist for the user and keep it up to date with their most recently played music. The user can then chose to share the playlist with others.

The website allows the user to log in with their spotify credentials. The site will store the user's oauth token to be used with the spotipy library. The site will have a cron job that runs frequently to update the playlist with the user's most recently played songs. 

## Requirements
- Website must have a python backend
- Frontend should be very simple. Allow a user to log in and name the newly created playlist.
- Backend must store the name of the playlist and oauth token.
- Python requirements should be stored in requirements.txt
- Use pip. Do not use uv.

## Plan

### Backend Setup
1. Initialize Python project with FastAPI.
2. Set up database Sqlite to store:
   - User ID
   - Spotify OAuth token
   - Playlist name
   - Playlist ID
3. Implement Spotify OAuth flow:
   - Redirect to Spotify login
   - Handle callback and store access token
4. Create cron job for playlist updates:
   - Fetch user's recently played tracks
   - Add new tracks to their playlist
   - Run on a schedule (e.g., hourly)

### Frontend Setup
1. Create simple login page:
   - "Login with Spotify" button
   - Redirects to backend OAuth endpoint
2. Create playlist creation page:
   - Input field for playlist name
   - Submit button
   - Confirmation after creation

### API Endpoints
- `GET /login` - Initiate Spotify OAuth
- `GET /callback` - Handle Spotify OAuth callback
- `POST /playlist` - Create new playlist (requires name)
- `GET /user` - Get current user info (if authenticated)

### Database Schema
- Users table: id, spotify_id, access_token, refresh_token
- Playlists table: id, user_id, playlist_name, spotify_playlist_id, created_at